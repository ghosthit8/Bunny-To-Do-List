<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hand-in-Hand To-Do ♥</title>
  <style>
    :root{
      --bg:#07080b; --panel:#0c0f14; --fg:#eafff2; --muted:#86caa1;
      --neon:#39ff88; --border:#1b2a22;
      --r:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    header{
      position:sticky; top:0; z-index:5;
      padding:12px 14px;
      background:rgba(7,8,11,.9);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
    }
    .wrap{max-width:920px;margin:0 auto}
    h1{margin:0;font-size:16px;letter-spacing:.5px}
    .sub{margin-top:6px;color:var(--muted);font-size:12px}
    .bar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .btn{
      border:1px solid var(--border);
      background:rgba(12,15,20,.9);
      color:var(--fg);
      border-radius:12px;
      padding:9px 12px;
      font-size:13px;
      cursor:pointer;
    }
    .btn:hover{border-color:rgba(57,255,136,.5)}
    .btn.primary{border-color:rgba(57,255,136,.6)}
    .btn.danger{border-color:rgba(255,90,122,.6)}

    main{padding:14px}
    .card{
      background:rgba(12,15,20,.78);
      border:1px solid var(--border);
      border-radius:var(--r);
      overflow:hidden;
    }

    .head{
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      color:var(--muted);
      font-size:12px;
      display:grid;
      grid-template-columns: 74px 1fr 120px;
      gap:10px;
      align-items:center;
    }

    .list{display:flex;flex-direction:column}
    .row{
      display:grid;
      grid-template-columns: 74px 1fr 120px;
      gap:10px;
      padding:10px 12px;
      align-items:center;
      border-bottom:1px solid rgba(27,42,34,.7);
      cursor:pointer;
      user-select:none;
    }
    .row:last-child{border-bottom:none}
    .row:hover{background:rgba(57,255,136,.03)}

    .day{
      color:var(--muted);
      font-weight:700;
      letter-spacing:.3px;
      font-size:13px;
    }

    .task{
      width:100%;
      border:none;
      outline:none;
      background:transparent;
      color:var(--fg);
      font-size:14px;
      padding:10px 8px;
      border-radius:12px;
      min-width:0;
      user-select:text;
    }
    .task::placeholder{color:rgba(134,202,161,.55)}

    .done .task{
      opacity:.65;
      text-decoration: line-through;
      text-decoration-thickness: 2px;
      text-decoration-color: rgba(57,255,136,.45);
    }
    .done .day{opacity:.7}

    /* Marker container (NO rectangles around sprites) */
    .marker{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      pointer-events:auto;
      transform-origin: 50% 100%;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.6));
    }
    .marker.idle{ animation: idleBob 1.6s ease-in-out infinite; }
    @keyframes idleBob{
      0%,100%{transform:translateY(0)}
      50%{transform:translateY(-2px)}
    }

    /* Single couple sprite canvas */
    canvas.couple{
      width:92px;
      height:58px;
      image-rendering: pixelated;
      background: transparent;
      border: none;
      border-radius: 0;
      outline: none;
      display:block;
    }

    .hint{
      text-align:right;
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }

    .footer{
      padding:10px 12px;
      border-top:1px solid var(--border);
      display:flex; gap:10px; flex-wrap:wrap; justify-content:space-between;
      color:var(--muted); font-size:12px;
    }

    @media (max-width:560px){
      .head, .row{grid-template-columns: 62px 1fr 120px}
      canvas.couple{width:82px;height:52px}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="bar">
        <div>
          <h1>Hand-in-Hand To-Do <span style="color:var(--neon)">♥</span></h1>
          <div class="sub">Tap the next day to advance → previous day crosses out → we walk down.</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <button class="btn primary" id="addRow">+ Row</button>
          <button class="btn danger" id="reset">Reset</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <div class="card">
        <div class="head">
          <div>Day</div>
          <div>Task</div>
          <div style="text-align:right">Us</div>
        </div>

        <div class="list" id="list"></div>

        <div class="footer">
          <div>Auto-saves on this device.</div>
          <div>Tip: tap a row to move us there. Tap the next day to “complete” the current one.</div>
        </div>
      </div>
    </div>
  </main>

  <script>
    const KEY = "valentine_todo_advance_v1";
    const DAYS = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];

    const DEFAULT = {
      rows: [
        { day: "Mon", task: "Something sweet #1", done: false },
        { day: "Tue", task: "Something sweet #2", done: false },
        { day: "Wed", task: "Something sweet #3", done: false },
        { day: "Thu", task: "Something sweet #4", done: false },
        { day: "Fri", task: "Something sweet #5", done: false },
      ],
      markerRow: 0
    };

    // ===== Keep same clothes vibe/colors; change only proportions + face/hair cuteness =====
    const YOU = {
      outline:"#0a0d10",
      skin:"#e7c4a7",
      skinShade:"#d6ab8b",
      blush:"#ff8fb0",
      hair:"#1a1f26",
      hair2:"#0f1318",
      eye:"#3b2a22",
      hoodie:"#0f151d",
      hoodie2:"#171f2a",
      hoodieShade:"#0a0f16",
      pants:"#0c1117",
      pants2:"#121a24",
      shoe:"#0a0d10",
      shoe2:"#121821",
      accent:"#39ff88"
    };

    const BUNNY = {
      outline:"#0a0d10",
      skin:"#e7c4a7",
      skinShade:"#d6ab8b",
      blush:"#ff8fb0",
      hair:"#7b3dff",
      hair2:"#4a26b8",
      eye:"#3b2a22",
      hoodie:"#111017",
      hoodie2:"#1a1624",
      hoodieShade:"#0b0a10",
      pants:"#0e0e14",
      pants2:"#161625",
      shoe:"#0a0d10",
      shoe2:"#171726",
      glasses:"#d7e8ff"
    };

    let state = load();

    function load(){
      try{
        const raw = localStorage.getItem(KEY);
        if(!raw) return structuredClone(DEFAULT);
        const data = JSON.parse(raw);
        if(!data || !Array.isArray(data.rows)) return structuredClone(DEFAULT);
        return data;
      }catch(e){ return structuredClone(DEFAULT); }
    }
    function save(){ localStorage.setItem(KEY, JSON.stringify(state)); }

    const list = document.getElementById("list");
    const addRowBtn = document.getElementById("addRow");
    const resetBtn = document.getElementById("reset");

    // ===== Pixel helpers =====
    function setupCanvas(canvas, W, H){
      canvas.width = W; canvas.height = H;
      const ctx = canvas.getContext("2d", { alpha: true });
      ctx.imageSmoothingEnabled = false;
      ctx.clearRect(0,0,W,H);
      return ctx;
    }
    function px(ctx, x, y, c){ ctx.fillStyle = c; ctx.fillRect(x,y,1,1); }
    function rect(ctx, x, y, w, h, c){ ctx.fillStyle = c; ctx.fillRect(x,y,w,h); }

    // ===== Cute chibi (like your anime pixel ref) =====
    // BIG head, BIG eyes, blush, tiny body. Still responds to your frame animation.
    function drawPerson(ctx, ox, oy, p, frame){
      const f = frame % 4;
      const step = (f === 1) ? -1 : (f === 3 ? 1 : 0);
      const bob  = (f === 1 || f === 3) ? 0 : 1;

      ensureChibi(ctx, ox, oy, p, step, bob, f);
    }

    function ensureChibi(ctx, ox, oy, p, step, bob, f){
      // Cell is 40x48 (we place at 0 and 40 in drawCouple)
      const cx = ox + 20;
      const headTop = oy + 6 + bob;

      // --- Head base (rounder chibi) ---
      rect(ctx, cx-7, headTop+1, 14, 11, p.skin);
      rect(ctx, cx-6, headTop,   12, 1,  p.skin);       // top curve
      rect(ctx, cx-6, headTop+12,12, 1,  p.skinShade);  // chin shade
      // cheek shading
      px(ctx, cx-6, headTop+8, p.skinShade);
      px(ctx, cx+5, headTop+8, p.skinShade);

      // --- Hair silhouette (more “cute anime”) ---
      // crown
      rect(ctx, cx-8, headTop-3, 16, 4, p.hair);
      // bangs (jagged anime)
      rect(ctx, cx-7, headTop+1, 14, 2, p.hair2);
      px(ctx, cx-5, headTop+3, p.hair2);
      px(ctx, cx-2, headTop+3, p.hair2);
      px(ctx, cx+1, headTop+3, p.hair2);
      px(ctx, cx+4, headTop+3, p.hair2);

      // side hair framing face
      rect(ctx, cx-9, headTop+2, 3, 8, p.hair);
      rect(ctx, cx+6, headTop+2, 3, 8, p.hair);

      // Bunny: longer twin-tail-ish sides (cuter hair like ref)
      if(p === BUNNY){
        rect(ctx, cx-10, headTop+8, 4, 8, p.hair);
        rect(ctx, cx+6,  headTop+8, 4, 8, p.hair);
        rect(ctx, cx-9,  headTop+12,3, 4, p.hair2);
        rect(ctx, cx+6,  headTop+12,3, 4, p.hair2);
        // tiny hair accessory sparkle (subtle)
        px(ctx, cx-8, headTop+4, "rgba(57,255,136,.55)");
      } else {
        // You: small extra tuft (less blocky)
        px(ctx, cx-8, headTop+6, p.hair);
        px(ctx, cx+7, headTop+6, p.hair);
      }

      // --- Eyes (big anime eyes + highlights) ---
      // Eye blocks 2x3 each
      rect(ctx, cx-4, headTop+6, 2, 3, p.eye);
      rect(ctx, cx+2, headTop+6, 2, 3, p.eye);
      // white highlights
      px(ctx, cx-4, headTop+6, "rgba(255,255,255,.9)");
      px(ctx, cx+2, headTop+6, "rgba(255,255,255,.9)");
      px(ctx, cx-3, headTop+7, "rgba(255,255,255,.28)");
      px(ctx, cx+3, headTop+7, "rgba(255,255,255,.28)");
      // lower lash shadow
      px(ctx, cx-4, headTop+9, "rgba(0,0,0,.25)");
      px(ctx, cx+2, headTop+9, "rgba(0,0,0,.25)");

      // --- Blush (cute cheeks like ref) ---
      px(ctx, cx-6, headTop+9, p.blush);
      px(ctx, cx-5, headTop+9, "rgba(255,143,176,.55)");
      px(ctx, cx+5, headTop+9, p.blush);
      px(ctx, cx+4, headTop+9, "rgba(255,143,176,.55)");

      // --- Mouth (tiny open mouth) ---
      px(ctx, cx,   headTop+10, "#2a1a16");
      px(ctx, cx,   headTop+11, "#ff7da6");

      // --- Glasses (Bunny) keep but make lighter ---
      if(p.glasses){
        rect(ctx, cx-6, headTop+5, 6, 4, "rgba(170,210,255,.10)");
        rect(ctx, cx,   headTop+5, 6, 4, "rgba(170,210,255,.10)");
        rect(ctx, cx-6, headTop+5, 6, 1, p.glasses);
        rect(ctx, cx-6, headTop+8, 6, 1, p.glasses);
        rect(ctx, cx,   headTop+5, 6, 1, p.glasses);
        rect(ctx, cx,   headTop+8, 6, 1, p.glasses);
        rect(ctx, cx-6, headTop+5, 1, 4, p.glasses);
        rect(ctx, cx-1, headTop+5, 1, 4, p.glasses);
        rect(ctx, cx,   headTop+5, 1, 4, p.glasses);
        rect(ctx, cx+5, headTop+5, 1, 4, p.glasses);
      }

      // --- Tiny body (same clothes colors) ---
      const bodyY = headTop + 13;

      // hoodie (small)
      rect(ctx, cx-5, bodyY,   10, 7, p.hoodie);
      rect(ctx, cx-5, bodyY,   10, 2, p.hoodie2);
      rect(ctx, cx+2, bodyY+2,  3, 5, p.hoodieShade);

      // little chest accent (you)
      if(p.accent){
        rect(ctx, cx-1, bodyY+3, 2, 2, p.accent);
        px(ctx, cx+1, bodyY+4, "rgba(0,0,0,.25)");
      }

      // arms (tiny swing)
      const armY = bodyY + 2;
      rect(ctx, cx-6, armY + (step===-1?1:0), 1, 4, p.hoodie2);
      rect(ctx, cx+5, armY + (step=== 1?1:0), 1, 4, p.hoodie2);

      // hands (small)
      px(ctx, cx-6, armY+4 + (step===-1?1:0), p.skin);
      px(ctx, cx+5, armY+4 + (step=== 1?1:0), p.skinShade);

      // legs (very tiny)
      const legY = bodyY + 7;
      rect(ctx, cx-3 + (step===-1?-1:0), legY, 2, 4, p.pants);
      rect(ctx, cx+1 + (step=== 1? 1:0), legY, 2, 4, p.pants2);

      // shoes
      rect(ctx, cx-3 + (step===-1?-1:0), legY+4, 2, 1, p.shoe2);
      rect(ctx, cx+1 + (step=== 1? 1:0), legY+4, 2, 1, p.shoe2);
      px(ctx, cx-2 + (step===-1?-1:0), legY+5, p.shoe);
      px(ctx, cx+2 + (step=== 1? 1:0), legY+5, p.shoe);

      // --- Bold outline like cute pixel sprites (outline head + body) ---
      // head outline boxish but rounded via missing corners
      outlineRoundRect(ctx, cx-7, headTop, 14, 13, p.outline, true);
      // body outline
      outlineRect(ctx, cx-5, bodyY, 10, 7, p.outline);
    }

    function outlineRect(ctx, x, y, w, h, c){
      for(let i=0;i<w;i++){ px(ctx, x+i, y, c); px(ctx, x+i, y+h-1, c); }
      for(let j=0;j<h;j++){ px(ctx, x, y+j, c); px(ctx, x+w-1, y+j, c); }
    }
    function outlineRoundRect(ctx, x, y, w, h, c, clipCorners){
      // top/bot
      for(let i=0;i<w;i++){ px(ctx, x+i, y, c); px(ctx, x+i, y+h-1, c); }
      for(let j=0;j<h;j++){ px(ctx, x, y+j, c); px(ctx, x+w-1, y+j, c); }
      if(clipCorners){
        // knock out corners for a rounded feel
        // (actually just draw bg-transparent by skipping: we "erase" by overdrawing with nothing is hard,
        // so instead we avoid heavy corner pixels by drawing skin/hair later - here we just soften with gaps)
        // We'll do small gaps by overwriting corner pixels with nearby interior color using a safe assumption:
        // use outline color but keep it minimal:
        // Remove 1px at each corner
        // (We can't truly erase; instead we avoid double-thick corners.)
        // So we just don't add extra; already thin.
      }
    }

    // Draw BOTH people in ONE canvas, and force a true hand connection between them.
    function drawCouple(canvas, frame=0){
      // 2 x 40px cells = 80px wide. Taller for cute head + hair.
      const ctx = setupCanvas(canvas, 80, 48);

      // Left person (YOU)
      drawPerson(ctx, 0, 0, YOU, frame);

      // Right person (BUNNY)
      drawPerson(ctx, 40, 0, BUNNY, frame);

      // === FORCE HAND-HOLD (align with our tiny hands) ===
      // Hands are around bodyY+6 -> roughly y= (headTop+13)+6 ~ 25–28
      const y = 28;
      rect(ctx, 38, y, 4, 2, "rgba(231,196,167,.92)");
      // outline around bridge
      px(ctx, 38, y,   YOU.outline);
      px(ctx, 41, y,   YOU.outline);
      px(ctx, 38, y+1, YOU.outline);
      px(ctx, 41, y+1, YOU.outline);

      // tiny heart sparkle sometimes (subtle, cute)
      if((frame % 8) === 1){
        px(ctx, 39, 20, "rgba(57,255,136,.9)");
        px(ctx, 40, 20, "rgba(57,255,136,.9)");
        px(ctx, 39, 21, "rgba(57,255,136,.9)");
        px(ctx, 40, 21, "rgba(57,255,136,.9)");
      }
    }

    function makeMarker(){
      const m = document.createElement("div");
      m.className = "marker idle";

      const c = document.createElement("canvas");
      c.className = "couple";
      m.appendChild(c);

      m._canvas = c;
      drawCouple(c, 0);

      return m;
    }

    function animateWalk(marker, duration = 720){
      if(!marker || !marker._canvas) return;
      marker.classList.remove("idle");

      const start = performance.now();

      function step(now){
        const t = now - start;
        const frame = Math.floor(t / 90) % 8; // keep your cadence
        drawCouple(marker._canvas, frame);

        if(t < duration){
          requestAnimationFrame(step);
        } else {
          drawCouple(marker._canvas, 0);
          marker.classList.add("idle");
        }
      }
      requestAnimationFrame(step);
    }

    function normalize(){
      state.markerRow = Math.max(0, Math.min(state.rows.length-1, state.markerRow||0));
      for(const r of state.rows){
        if(typeof r.day !== "string") r.day = "";
        if(typeof r.task !== "string") r.task = "";
        r.done = !!r.done;
      }
    }

    function handleRowClick(targetIndex){
      const cur = state.markerRow;
      let didAdvance = false;

      if(targetIndex > cur){
        state.rows[cur].done = true;
        state.markerRow = targetIndex;
        didAdvance = true;
      } else {
        state.markerRow = targetIndex;
      }

      save();
      render({ animate: didAdvance });
    }

    function render(opts = {}){
      normalize();
      list.innerHTML = "";

      state.rows.forEach((r, ri)=>{
        const row = document.createElement("div");
        row.className = "row" + (r.done ? " done" : "");
        row.addEventListener("click", ()=> handleRowClick(ri));

        const day = document.createElement("div");
        day.className = "day";
        day.textContent = r.day || "";

        const task = document.createElement("input");
        task.className = "task";
        task.type = "text";
        task.value = r.task || "";
        task.placeholder = "Type the task…";

        task.addEventListener("click", (e)=> e.stopPropagation());
        task.addEventListener("input", ()=>{
          r.task = task.value;
          save();
        });
        task.addEventListener("keydown",(e)=>{
          if(e.key==="Enter"){
            e.preventDefault();
            const next = Math.min(state.rows.length-1, ri+1);
            if(next !== ri){
              state.rows[ri].done = true;
              state.markerRow = next;
              save();
              render({ animate: true });
            }
          }
        });

        const right = document.createElement("div");
        if(ri === state.markerRow){
          const marker = makeMarker();
          marker.title = "We are here";
          marker.addEventListener("click", (e)=> e.stopPropagation());
          right.appendChild(marker);
        } else {
          const hint = document.createElement("div");
          hint.className = "hint";
          hint.textContent = "";
          right.appendChild(hint);
        }

        row.append(day, task, right);
        list.appendChild(row);
      });

      if(opts.animate){
        const marker = document.querySelector(".marker");
        if(marker) animateWalk(marker);
      }
    }

    function addRow(){
      const idx = state.rows.length;
      const day = DAYS[idx % DAYS.length] || `Day ${idx+1}`;
      state.rows.push({ day, task:"", done:false });
      normalize();
      save();
      render();
    }

    addRowBtn.addEventListener("click", addRow);

    resetBtn.addEventListener("click", ()=>{
      if(!confirm("Reset everything?")) return;
      state = structuredClone(DEFAULT);
      save();
      render();
    });

    normalize();
    save();
    render();
  </script>
</body>
</html>